https://filmslist-e1454.web.app/
---
# Список фильмов
Приложение позволяет просматривать информацию о фильмах, организованную в виде записей таблицы, добавлять новые и удалять имеющиеся записи.
## Описание приложения
Задание было выполнено с использованием **React**, стилизация всех элементов страницы, а так же модальное окно, сделано с помощью компонентов из фреймворка **Semantic UI**, для получения данных из форм модального окна используется библиотека **Formik**, а для их валидации **Yup**. Все данные для записей о фильмах хранятся в облачной базе данных **Cloud Firestore**. Хостинг осуществляется с помощью **Firebase Hosting**.
> На самом деле большая часть из используемых инструментов не являются необходимыми: объект **document** содержит все необходимые методы и свойства, которых было бы достаточно для организации добавления/удаления записей, получения введенных значений из форм и их валидации. А **LocalStorage** мог бы заменить базу данных. Опыт написания приложения без вышеперечисленных инструментов **[имеется](https://github.com/qbLua/calc)** (это было давно, а о чистоте и правильности кода я тогда не задумывался).

### Компоненты приложения
Все видимые элементы страницы находятся внутри компоненты **Main** в файле *[main.jsx](src/src/components/main.jsx)*
Помимо двух компонент с кнопкой для добавления и таблицей, данная компонента содержит функцию и хук состояния для обновления списка фильмов. 
```javascript
  const [list, setList] = useState([]);
  const getList = () => {
    const listFilms = [];
    db.collection("films").orderBy("dateAdd", "desc").get().then((querySnapshot) => {
      querySnapshot.forEach((doc) => {
        listFilms.push(doc.data())
        listFilms[listFilms.length-1].id = doc.id;
      });
      setList(listFilms)
    });
    console.log(listFilms)
  }
```
Функция *getList* обращается к таблице *films* из базы данных, записи из которой помещает в хук состояния *list*, что заставляет компоненту перерисоваться и отобразить все записи с фильмами. Сортировка полученных записей выполняется по дате добавления записи -- по умолчанию записи в БД  **Cloud Firestore** упорядочиваются по уникальному идентификатору, поэтому чтобы отсортировать записи в порядке их создания, было добавлено поле с датой, которое нигде не отображается и используется только для сортировки.

Компонента **ModalWindow** из файла *[Modal.jsx](src/src/components/Modal.jsx)* содержит формы модального окна. Поля для ввода содержат валидацию, которая не позволяет добавить бессмысленные записи. Данная компонента используется как для добавления новой записи, так и для ее редактирования. Свое поведение компонента определяет, исходя из пропса edit, который говорит, что в данный момент цель компоненты — отредактировать запись, в ином случает она работает на добавление записи. Можно было бы заменить пропс edit на type, в который бы передавались значения 'edit' или 'add', но так как модальное окно работает только в двух режимах, то достаточно проверить является ли оно окном на редактирование — в противном случае на добавление. Новая запись не будет напрямую добавлена на страницу приложения, вместо этого она добавится в базу данных, затем в результате запроса к БД будет получен новый список записей, который и будет отражен на странице.

Сам список фильмов находится в компоненте **TableFilms** ([TableFilms.jsx](src/src/components/tableFilms.jsx)), где каждым отдельным элементом списка является компонента **Item** ([Item.jsx](src/src/components/Item.jsx)). Каждый элементы списка имеет кнопку для удаления, которая удаляет из БД запись с идентификатором, соответствующим данной записи, и вызывает обновление списка фильмов.

### Валидация форм
Проверка введенных значений происходит с помощью библиотеки **Yup**.
Для полей формы были установлены следующие ограничения:
- *Название* не может быть пустой строкой или пробелом. Было довольно странно умышленно допускать варианты вида: **[1](https://www.kinopoisk.ru/film/794704/)**, **[Z](https://www.kinopoisk.ru/film/8344/)**, **[Q](https://www.kinopoisk.ru/film/13662/)**, **[O](https://www.kinopoisk.ru/film/769/)**, **[M](https://www.kinopoisk.ru/film/54155/)**. Но тем не менее фильмы с такими названиями существуют и было решено ограничиться только запретом на отсутствие какого-либо названия.
- *Дата* не может быть больше сегодняшнего дня — было бы неправильно указывать рейтинг еще не вышедшему фильму.
- Для *режиссера* были установлены такие же ограничения как и для названия фильма. Потому как вместо имени режиссера вполне может быть указан его псевдоним, который может содержать один символ.
- *Продолжительность* не может быть пустой или нулевой.
- *Рейтинг* это только целое число от 1 до 10.